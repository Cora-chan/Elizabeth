{% schema %}
{
  "name": "Marquee Banner",
  "settings": [
    {
      "type": "text",
      "id": "banner_text",
      "label": "Banner Text",
      "default": "This is an example of an infinite scrolling banner..."
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Scroll Speed (1 = slowest)",
      "min": 1,
      "max": 10,
      "default": 2
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#1D1813"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#FFFFFF"
    }
  ],
  "presets": [{ "name": "Marquee Banner" }]
}
{% endschema %}

{% comment %} <div style="background-color: {{ section.settings.bg_color }};" class="w-full overflow-hidden">
  <div id="marquee-container" class="inline-block whitespace-nowrap w-96" >
    <span id="marquee-text" class="font-roboto inline-block pr-16" style="color: {{ section.settings.text_color }};">
      {{ section.settings.banner_text }}
    </span>
    <span class="font-roboto inline-block pr-16" style="color: {{ section.settings.text_color }};">
      {{ section.settings.banner_text }}
    </span>
  </div>
</div> {% endcomment %}


<section class="p-4" style="background-color: {{ section.settings.bg_color }};">
  <div id="marquee" class="flex overflow-hidden select-none">
    <span class="marquee__content font-roboto shrink-0 flex justify-around min-w-full gap-4" aria-hidden="true" style="color: {{ section.settings.text_color }};">
     {{ section.settings.banner_text }}
    </span>
    <span class="marquee__content font-roboto shrink-0 flex justify-around min-w-full gap-4" aria-hidden="true" style="color: {{ section.settings.text_color }};">
      {{ section.settings.banner_text }}
    </span>
  </div>
</section>

<style>
/* Add a smooth leftward animation */
@keyframes marquee-scroll {
  0% {
    transform: translateX(0%);
  }
  100% {
    transform: translateX(-100%);
  }
}

/* Apply animation to the ULs */
#marquee .marquee__content {
  animation: marquee-scroll 20s linear infinite;
}
</style>


{% comment %} 
{% comment %} <script>
document.addEventListener('DOMContentLoaded', function() {
  const container = document.getElementById('marquee-container');
  const speed = {{ section.settings.speed }}; 

  let pos = 0;
  function scrollTicker() {
    pos -= speed * 0.3; // smoother speed, scales nicely
    const containerWidth = container.scrollWidth / 2; // we duplicated text
    if (Math.abs(pos) >= containerWidth) pos = 0; // reset only after one full width
    container.style.transform = `translateX(${pos}px)`;
    requestAnimationFrame(scrollTicker);
  }

  scrollTicker();
}); {% endcomment %}
</script> {% endcomment %}
