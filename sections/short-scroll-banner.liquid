<!-- sections/scroll-banner.liquid -->
<section id="scroll-banner-{{ section.id }}" class="w-full bg-[{{ section.settings.bg_color }}] py-3 rounded-lg">
  <div class="max-w-screen-xl mx-auto flex items-center gap-3 px-4">
    
    <!-- Icon area -->
    <div class="flex-shrink-0 w-12 h-12 flex items-center justify-center" aria-hidden="true">
      <div id="sb-icon-{{ section.id }}" class="w-12 h-12"></div>
    </div>

    <!-- Text area -->
    <div class="flex-1 overflow-hidden">
      <div id="sb-viewport-{{ section.id }}" class="relative h-12">
        {% for block in section.blocks %}
          <div class="sb-item absolute left-0 right-0 top-0 opacity-0 translate-y-2 flex items-center h-12 transition-all duration-500 ease-in-out"
               data-block-id="{{ block.id }}"
               data-icon-type="{{ block.settings.icon_type }}">
            <div class="text-lg font-semibold text-gray-900">{{ block.settings.subtitle_text }}</div>
            {% if block.settings.custom_svg != blank %}
              <div class="sb-custom-svg hidden">{{ block.settings.custom_svg | escape }}</div>
            {% endif %}
          </div>
        {% endfor %}
      </div>

      {% if section.settings.small_note != blank %}
        <div class="text-xs text-gray-500 mt-1">{{ section.settings.small_note }}</div>
      {% endif %}
    </div>
  </div>

  <script>
    (function(){
      const items = Array.from(document.querySelectorAll('#sb-viewport-{{ section.id }} .sb-item'));
      if (!items.length) return;

      const iconTarget = document.getElementById("sb-icon-{{ section.id }}");
      const svgMap = {
        clothes: `<svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M3 7c0 0 4-3 9-3s9 3 9 3v9a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V7z"/></svg>`,
        female: `<svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M12 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm1 1h-2c-1.1 0-2 .9-2 2v3h6v-3c0-1.1-.9-2-2-2z"/></svg>`,
        fashion: `<svg viewBox="0 0 24 24" fill="currentColor" class="w-full h-full"><path d="M4 6h16v2H4zM5 10h14v9H5zM7 12v5h2v-5z"/></svg>`
      };

      function getSVG(item){
        const custom = item.querySelector('.sb-custom-svg');
        if(custom){
          let svg = custom.textContent || custom.innerText || '';
          return svg.replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&amp;/g,'&');
        }
        return svgMap[item.getAttribute('data-icon-type')] || svgMap.clothes;
      }

      let current = 0;
      const delay = {{ section.settings.cycle_interval | default: 3000 }};

      function show(i){
        items.forEach((it, idx)=>{
          it.classList.toggle('opacity-100', idx === i);
          it.classList.toggle('opacity-0', idx !== i);
          it.classList.toggle('translate-y-0', idx === i);
          it.classList.toggle('translate-y-2', idx !== i);
        });
        iconTarget.innerHTML = getSVG(items[i]);
      }

      show(current);
      let timer = setInterval(()=>{
        current = (current + 1) % items.length;
        show(current);
      }, delay);

      const banner = document.getElementById("scroll-banner-{{ section.id }}");
      banner.addEventListener('mouseenter', ()=> clearInterval(timer));
      banner.addEventListener('mouseleave', ()=> timer = setInterval(()=>{
        current = (current + 1) % items.length;
        show(current);
      }, delay));
    })();
  </script>

 {% schema %}
{
  "name": "Short Scrolling Banner",
  "settings": [
    {
      "type": "text",
      "id": "aria_label",
      "label": "ARIA label",
      "default": "Site short banner"
    },
    {
      "type": "text",
      "id": "small_note",
      "label": "Small note",
      "default": "note"
    },
    {
      "type": "number",
      "id": "cycle_interval",
      "label": "Cycle interval (ms)",
      "default": 3000
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background color",
      "default": "#FFFFFF"
    }
  ],
  "blocks": [
    {
      "type": "subtitle",
      "name": "Subtitle",
      "settings": [
        {
          "type": "text",
          "id": "subtitle_text",
          "label": "Subtitle text",
          "default": "New arrivals — shop now"
        },
        {
          "type": "select",
          "id": "icon_type",
          "label": "Icon",
          "options": [
            { "value": "clothes", "label": "Clothes" },
            { "value": "female", "label": "Female" },
            { "value": "fashion", "label": "Fashion" }
          ],
          "default": "clothes"
        },
        {
          "type": "textarea",
          "id": "custom_svg",
          "label": "Custom SVG (optional)",
          "default": "placefor SVG code"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Short scrolling banner (3 items)",
      "category": "Banner",
      "blocks": [
        { "type": "subtitle", "settings": { "subtitle_text": "New: Summer Collection", "icon_type": "clothes" } },
        { "type": "subtitle", "settings": { "subtitle_text": "For Her: Styles You'll Love", "icon_type": "female" } },
        { "type": "subtitle", "settings": { "subtitle_text": "Trend Picks — Limited Stock", "icon_type": "fashion" } }
      ]
    }
  ]
}
{% endschema %}

</section>
